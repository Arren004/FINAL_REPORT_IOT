<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IoT Dashboard</title>
    <link rel="stylesheet" href="style1.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
</head>
<body>
    <div class="sidebar">
        <h2 class="store-title">Quản lý cửa hàng</h2>
        <ul>
            <li><a href="#">Trang chủ</a></li>
            <li><a href="#">Điều khiển</a></li>
            <li><a href="#">Giám sát</a></li>
        </ul>
    </div>
    <div class="main-content">
        <header >
            <h1>Thế giới linh Kiện</h1>
            <div class="time" id="time"></div>
        </header>
      
        
        <!-- Phần Trang chủ -->
        <div class="home-section">
            <div class="working-hours">
                <h2>Thời gian làm việc</h2>
                <p>T2 - T6: Sáng 7H30 > 12H00 - Chiều 13H30 > 20H00</p>
                <p>T7 - CN: Sáng 8H00 > 12H00 - Chiều 13H30 > 17H00</p>
            </div>
            <div class="products">
                <div class="product-card">
                    <img src="image/khoan.jpg" alt="Mũi khoan 4MM">
                    <h3>Mũi khoan 4MM</h3>
                    <p class="price">999.990đ</p>
                    <button class="buy-button">Mua ngay</button>
                </div>
                <div class="product-card">
                    <img src="image/de.jpg" alt="Đế relay GB-114P">
                    <h3>Đế relay GB-114P</h3>
                    <p class="price">350.000đ</p>
                    <button class="buy-button">Mua ngay</button>
                </div>
                <div class="product-card">
                    <img src="image/de_esp.jpg" alt="Đế mở rộng esp32 30 chân">
                    <h3>Đế mở rộng esp32 30 chân</h3>
                    <p class="price">390.000đ</p>
                    <button class="buy-button">Mua ngay</button>
                </div>
                <div class="product-card">
                    <img src="image/arduino.jpg" alt="Arduino UNO R3 DIP (kèm cáp)">
                    <h3>Arduino UNO R3 DIP (kèm cáp)</h3>
                    <p class="price">500.000đ</p>
                    <button class="buy-button">Mua ngay</button>
                </div>
            </div>
            <div class="products">
                <div class="product-card">
                    <img src="image/pino.jpg" alt="Mũi khoan 4MM">
                    <h3>Pin tiểu AAA con Ó Pinaco</h3>
                    <p class="price">999.990đ</p>
                    <button class="buy-button">Mua ngay</button>
                </div>
                <div class="product-card">
                    <img src="image/AMC7135.jpg" alt="Đế relay GB-114P">
                    <h3>AMC7135</h3>
                    <p class="price">350.000đ</p>
                    <button class="buy-button">Mua ngay</button>
                </div>
                <div class="product-card">
                    <img src="image/banh.jpg" alt="Đế mở rộng esp32 30 chân">
                    <h3>Động cơ giảm tốc V1 + Bánh xe</h3>
                    <p class="price">390.000đ</p>
                    <button class="buy-button">Mua ngay</button>
                </div>
                <div class="product-card">
                    <img src="image/esp.jpg" alt="Arduino UNO R3 DIP (kèm cáp)">
                    <h3>ESP32-S3 N16R8 DevKitC Module Wifi Bluetooth</h3>
                    <p class="price">500.000đ</p>
                    <button class="buy-button">Mua ngay</button>
                </div>
            </div>
        </div>
        
        <!-- Phần Điều khiển -->
     <!-- Phần Điều khiển -->
<div class="control-section" style="display: none;">
    <h2>ĐIỀU KHIỂN THIẾT BỊ</h2>
    
    <div class="device-controls">
        <!-- Cửa ra vào -->
        <div class="control-card">
            <div class="control-header">
                <img id="img" src="image/door.png" class="fas fa-door-open" width="50px" height="50px">
                <h3>Cửa ra vào</h3>
            </div>
            <div class="control-buttons">
                <button id="btn1" class="control-btn open-btn">
                    <i class="fas fa-door-open"></i> Mở cửa
                </button>
                <button id="btn2" class="control-btn close-btn">
                    <i class="fas fa-door-closed"></i> Đóng cửa
                </button>
            </div>
            <div class="status-indicator">
                Trạng thái: <span class="status-text">Đang đóng</span>
            </div>
        </div>
        
        <!-- Đèn chiếu sáng -->
        <div class="control-card">
            <div class="control-header">
                <img id="den" src="image/den1.png" class="fas fa-power-off" width="50px" height="50px">
                <h3>Đèn chiếu sáng</h3>
            </div>
            <div class="control-buttons">
                <button id="btn3" class="control-btn on-btn">
                    <i class="fas fa-power-off"></i> Bật
                </button>
                <button id="btn4" class="control-btn off-btn">
                    <i class="fas fa-power-off"></i> Tắt
                </button>
            </div>
            <div class="status-indicator">
                Trạng thái: <span class="status-text">Đang tắt</span>
            </div>
        </div>
        
        <!-- Hệ thống quạt -->
        <div class="control-card">
            <div class="control-header">
                <img id="quat"  src="image/fan.png" class="fas fa-door-open" width="40px" height="40px">
                <h3>Hệ thống quạt</h3>
            </div>
            <div class="control-buttons">
                <button id="btn5" class="control-btn on-btn">
                    <i class="fas fa-power-off"></i> Bật
                </button>
                <button id="btn6"  class="control-btn off-btn">
                    <i class="fas fa-power-off"></i> Tắt
                </button>
            </div>
            <div class="status-indicator">
                Trạng thái: <span class="status-text">Đang tắt</span>
            </div>
        </div>
    </div>
</div>
        
        <!-- Phần Giám sát (Đã cập nhật) -->
        <div class="monitor-section" style="display: none;">
            <h2>Giám sát Môi trường Thông minh</h2>
            
            <div class="sensor-grid">
                <div class="sensor-card" id="temp-card">
                    <div class="sensor-header">
                        <div class="sensor-icon">
                            <i class="fas fa-thermometer-half"></i>
                        </div>
                        <div>
                            <div class="sensor-title">Nhiệt độ</div>
                            <div id="Temp" class="sensor-value"></div>
                            <div class="sensor-unit">°C</div>
                        </div>
                    </div>
                    <div class="sensor-status status-normal">Bình thường</div>
                </div>
                
                <div class="sensor-card" id="humidity-card">
                    <div class="sensor-header">
                        <div class="sensor-icon">
                            <i class="fas fa-tint"></i>
                        </div>
                        <div>
                            <div class="sensor-title">Độ ẩm</div>
                            <div id="Humi" class="sensor-value"></div>
                            <div class="sensor-unit">%</div>
                        </div>
                    </div>
                    <div class="sensor-status status-normal">Bình thường</div>
                </div>
                
                <div class="sensor-card" id="pm25-card">
                    <div class="sensor-header">
                        <div class="sensor-icon">
                            <i class="fas fa-smog"></i>
                        </div>
                        <div>
                            <div class="sensor-title">PM2.5</div>
                            <div id="Gas" class="sensor-value" id="pm25-value"></div>
                            <div class="sensor-unit">µg/m³</div>
                        </div>
                    </div>
                    <div class="sensor-status status-normal">Tốt</div>
                </div>
            </div>
            
            
            <div class="alerts-container" style="margin-top: 2rem;">
                <h3 style="margin-bottom: 1rem;">Cảnh báo Thời gian thực</h3>
                <div class="alert-list" id="alert-list">
                    <!-- Cảnh báo sẽ được thêm bằng JavaScript -->
                </div>
            </div>
            <div class="dashboard-container">
                <!-- Nhiệt độ -->
                <div class="chart-wrapper">
                  <div class="chart-header">
                    <i class="fas fa-thermometer-half"></i>
                    <h3>NHIỆT ĐỘ</h3>
                    <span class="current-value" id="currentTemp">--°C</span>
                  </div>
                  <canvas id="tempChart"></canvas>
                </div>
              
                <!-- Độ ẩm -->
                <div class="chart-wrapper">
                  <div class="chart-header">
                    <i class="fas fa-tint"></i>
                    <h3>ĐỘ ẨM</h3>
                    <span class="current-value" id="currentHumi">--%</span>
                  </div>
                  <canvas id="humiChart"></canvas>
                </div>
              
                <!-- Khí gas -->
                <div class="chart-wrapper">
                  <div class="chart-header">
                    <i class="fas fa-wind"></i>
                    <h3>KHÍ GAS</h3>
                    <span class="current-value" id="currentGas">--ppm</span>
                  </div>
                  <canvas id="gasChart"></canvas>
                </div>
              </div>
        
        </div>
    </div>
    
    <script src="script.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.2.10/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.2.10/firebase-database.js"></script>
    <!-- TODO: Add SDKs for Firebase products that you want to use
         https://firebase.google.com/docs/web/setup#available-libraries -->
    <script src="https://www.gstatic.com/firebasejs/8.2.10/firebase-analytics.js"></script>
    <!-- lien ket voi functions.js -->
    <script>
        // Your web app's Firebase configuration
        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
        var firebaseConfig = {
          apiKey: "AIzaSyAfv17-Mx88IFbSR2JsTAWVthP7sqBrhCo",
          authDomain: "tt-iot-d4f71.firebaseapp.com",
          databaseURL: "https://tt-iot-d4f71-default-rtdb.firebaseio.com",
          projectId: "tt-iot-d4f71",
          storageBucket: "tt-iot-d4f71.firebasestorage.app",
          messagingSenderId: "187063164241",
          appId: "1:187063164241:web:e5ed7eec0ed76957a00770",
          measurementId: "G-CVC4SF33KT"
        };
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        firebase.analytics();
    const database = firebase.database();
    /////////////////////////////////////////////////////////
  // Kết nối Firebase
// Kết nối và lấy dữ liệu từ Firebase theo đúng nhánh "Coso_IOT"
var dbRefTemp = firebase.database().ref('Coso_IOT/Temp');
dbRefTemp.on('value', snap => {
    const temp = snap.val();
    document.getElementById('Temp').innerText = temp;
    checkTemperature(temp); // Kiểm tra ngưỡng cảnh báo nhiệt độ
});

var dbRefHumi = firebase.database().ref('Coso_IOT/Humi');
dbRefHumi.on('value', snap => {
    const humi = snap.val();
    document.getElementById('Humi').innerText = humi;
    checkHumidity(humi); // Kiểm tra ngưỡng cảnh báo độ ẩm
});

var dbRefGas = firebase.database().ref('Coso_IOT/Gas');
dbRefGas.on('value', snap => {
    const gas = snap.val();
    document.getElementById('Gas').innerText = gas;
    checkGas(gas); // Kiểm tra ngưỡng cảnh báo khí gas
});

    </script>
</body>
</html>